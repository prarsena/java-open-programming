# Working with Images and Graphics

Java provides powerful tools for manipulating images and graphics through the `java.awt` (Abstract Window Toolkit) package. Even without building a GUI, we can write programs that process image files, draw shapes, and create art.

## Coming Attractions

Before we dive into the code, let's meet the stars of the show. These are the classes you will use most often when working with 2D graphics in Java.

*   **`BufferedImage`**: The canvas. It represents an image stored in memory that you can modify.
*   **`ImageIO`**: The loader/saver. It handles reading images from disk (JPG, PNG, GIF) and writing them back out.
*   **`Graphics` / `Graphics2D`**: The artist. This object provides methods to draw lines, rectangles, ovals, and text onto a `BufferedImage`.
*   **`Color`**: The palette. It represents colors using Red, Green, and Blue (RGB) components.
*   **`Font`**: The typography. It defines the style, size, and family of the text you draw.

## 1. The Canvas: BufferedImage

The core class for handling images in memory is `java.awt.image.BufferedImage`. It represents an image with an accessible buffer of image data.

To read and write images, we use `javax.imageio.ImageIO`.

```java
import java.awt.image.BufferedImage;
import java.io.File;
import javax.imageio.ImageIO;

public class ImageLoader {
    void main() throws Exception {
        File file = new File("image.jpg");
        BufferedImage image = ImageIO.read(file);
        
        System.out.println("Width: " + image.getWidth());
        System.out.println("Height: " + image.getHeight());
    }
}
```

## 2. The Artist: Graphics2D

While you can manipulate pixels directly (as we'll see later), it's often easier to "draw" on an image. You can get a `Graphics2D` object from any `BufferedImage`.

```java
BufferedImage image = new BufferedImage(500, 500, BufferedImage.TYPE_INT_RGB);
Graphics2D g = image.createGraphics();

// Now we can draw!
g.setColor(Color.RED);
g.fillRect(0, 0, 500, 500); // Fill background with red
```

### Drawing Shapes

The `Graphics` class has methods for all standard shapes:

*   `drawLine(x1, y1, x2, y2)`
*   `drawRect(x, y, width, height)` / `fillRect(...)`
*   `drawOval(x, y, width, height)` / `fillOval(...)`
*   `drawPolygon(xPoints, yPoints, nPoints)`

### Drawing Text

You can also draw text directly onto an image. This is how you might create a meme generator or add watermarks.

```java
g.setFont(new Font("Arial", Font.BOLD, 48));
g.setColor(Color.WHITE);
g.drawString("Hello Java!", 50, 100);
```

## 3. The Palette: Color

The `java.awt.Color` class is used to set the current drawing color.

### Built-in Colors
Java provides constants for standard colors: `Color.RED`, `Color.BLUE`, `Color.GREEN`, `Color.BLACK`, `Color.WHITE`, etc.

### Custom Colors
You can create any color by specifying its Red, Green, and Blue (RGB) components (0-255).

```java
Color myPurple = new Color(128, 0, 128);
g.setColor(myPurple);
```

### Transparency (Alpha)
You can also add a fourth parameter for "Alpha" (transparency), where 0 is invisible and 255 is solid.

```java
Color semiTransparentBlue = new Color(0, 0, 255, 128); // 50% see-through
```

## 4. Pixel Manipulation

Sometimes drawing shapes isn't enough. You want to change the image pixel by pixel. We can access the color of any pixel using `getRGB(x, y)` and change it using `setRGB(x, y, color)`.

### Example: Inverting Colors

Here is a program that reads an image, inverts every pixel's color (like a photo negative), and saves the result.

```java
import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.File;
import java.util.Scanner;
import javax.imageio.ImageIO;

public class ImageInverter {
    void main() throws Exception {
        Scanner scanner = new Scanner(System.in);
        System.out.print("Enter the path to an image file: ");
        String filePath = scanner.nextLine();
        
        File selectedFile = new File(filePath);
        if (!selectedFile.exists()) {
            System.out.println("File not found!");
            return;
        }

        BufferedImage image = ImageIO.read(selectedFile);
        
        // Process the image
        invertColors(image);
        
        // Save the new image
        File outputFile = new File("inverted-image.jpg");
        ImageIO.write(image, "jpg", outputFile);
        System.out.println("Saved to " + outputFile.getAbsolutePath());
    }

    void invertColors(BufferedImage image) {
        int w = image.getWidth();
        int h = image.getHeight();

        for (int x = 0; x < w; x++) {
            for (int y = 0; y < h; y++) {
                // Get current color
                Color c = new Color(image.getRGB(x, y));
                
                // Invert components
                int newRed = 255 - c.getRed();
                int newGreen = 255 - c.getGreen();
                int newBlue = 255 - c.getBlue();
                
                // Set new color
                Color newColor = new Color(newRed, newGreen, newBlue);
                image.setRGB(x, y, newColor.getRGB());
            }
        }
    }
}
```

## Project: The Meme Generator

Let's combine `Graphics2D`, `Font`, and `ImageIO` to create a simple meme generator. This program will load an image and write text at the top and bottom.

```java
import java.awt.*;
import java.awt.image.BufferedImage;
import java.io.File;
import javax.imageio.ImageIO;

public class MemeGenerator {
    void main() throws Exception {
        // 1. Load the image
        BufferedImage image = ImageIO.read(new File("cat.jpg"));
        
        // 2. Get the Graphics object
        Graphics2D g = image.createGraphics();
        
        // 3. Enable Anti-aliasing for smooth text
        g.setRenderingHint(
            RenderingHints.KEY_TEXT_ANTIALIASING, 
            RenderingHints.VALUE_TEXT_ANTIALIAS_ON
        );

        // 4. Setup Font
        int fontSize = image.getWidth() / 10; // Scale font to image width
        Font font = new Font("Impact", Font.BOLD, fontSize);
        g.setFont(font);
        
        // 5. Draw Text (Top)
        String topText = "I CAN HAS";
        drawCenteredString(g, topText, image.getWidth(), fontSize);
        
        // 6. Draw Text (Bottom)
        String bottomText = "JAVA?";
        drawCenteredString(g, bottomText, image.getWidth(), image.getHeight() - 20);
        
        // 7. Clean up and Save
        g.dispose();
        ImageIO.write(image, "jpg", new File("meme.jpg"));
    }

    void drawCenteredString(Graphics2D g, String text, int width, int y) {
        // Calculate x to center the text
        FontMetrics metrics = g.getFontMetrics();
        int x = (width - metrics.stringWidth(text)) / 2;
        
        // Draw Outline (Black)
        g.setColor(Color.BLACK);
        g.drawString(text, x+2, y+2);
        
        // Draw Text (White)
        g.setColor(Color.WHITE);
        g.drawString(text, x, y);
    }
}
```

This example demonstrates how powerful the standard library is. With just a few lines of code, we can perform complex image manipulation tasks.
